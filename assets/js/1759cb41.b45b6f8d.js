"use strict";(self.webpackChunkboehs_com=self.webpackChunkboehs_com||[]).push([[6684],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),h=a,f=p["".concat(c,".").concat(h)]||p[h]||m[h]||o;return n?r.createElement(f,i(i({ref:t},u),{},{components:n})):r.createElement(f,i({ref:t},u))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[p]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},3060:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const o={},i="Test if memcache is running and accessible",s={permalink:"/boehs.com/blog/2014/02/03/test-if-memcache-is-running-and-accessible.html",source:"@site/blog/2014-02-03-test-if-memcache-is-running-and-accessible.html.md",title:"Test if memcache is running and accessible",description:"I've been writing a Rails template for our future projects at Brightbit and I've been testing everything, including our application's environment. I've wrote a special rake task to test our different environments (development, test, staging, production, etc). This helps us ensure each environment is configured correctly. Ideally it would let the person running the tests know what is wrong with their environment and how to resolve it.",date:"2014-02-03T00:00:00.000Z",formattedDate:"February 3, 2014",tags:[],readingTime:1.295,hasTruncateMarker:!0,authors:[],frontMatter:{},prevItem:{title:"Parsing null terminated key/value ASCII strings in Ruby",permalink:"/boehs.com/blog/2014/10/31/parsing-null-terminated-key-value-ascii-strings-in-ruby.html"},nextItem:{title:"Sharing a team Heroku account",permalink:"/boehs.com/blog/2013/03/22/sharing-a-team-heroku-account.html"}},c={authorsImageUrls:[]},l=[],u={toc:l},p="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(p,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"I've been writing a Rails template for our future projects at ",(0,a.kt)("a",{parentName:"p",href:"http://brightbit.com"},"Brightbit")," and I've been testing everything, including our application's environment. I've wrote a special rake task to test our different environments (development, test, staging, production, etc). This helps us ensure each environment is configured correctly. Ideally it would let the person running the tests know what is wrong with their environment and how to resolve it."),(0,a.kt)("p",null,"One of the environment details I wanted to test was that memcache was setup and running correctly. I could of course test for the memcached binary or check if it was running, but since we are running these tests in the context of a Rails app, why not just ask Rails if it can connect to the memcache server?"),(0,a.kt)("p",null,"There's a multitude of ways to test for this. We don't have memcache setup in our test environment's config file, so I'll have to ask Rails to lookup a memcache store.  Also, I wanted to have something that would give a true/false rather than raise an exception (such as ",(0,a.kt)("inlineCode",{parentName:"p"},"Rails.cache.read 'some-made-up-key'"),"). After poking around a bit, I found that ",(0,a.kt)("inlineCode",{parentName:"p"},"Rails.cache.stats")," would always return something if memcache was up but have nil values in its result hash if it was down."),(0,a.kt)("p",null,"So, if you just want to check in your console, you can run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},"Rails.cache.stats.values.include? nil\n")),(0,a.kt)("p",null,"But since we're writing a test which doesn't have memcache configured, we'll need to ask ",(0,a.kt)("inlineCode",{parentName:"p"},"ActiveSupport")," to lookup a mem cache store:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},"ActiveSupport::Cache.lookup_store(:mem_cache_store).stats.values.include? nil\n")),(0,a.kt)("p",null,"So there ya go: quick and simple."))}m.isMDXComponent=!0}}]);