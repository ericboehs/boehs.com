"use strict";(self.webpackChunkboehs_com=self.webpackChunkboehs_com||[]).push([[6839],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>k});var r=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,o=function(e,t){if(null==e)return{};var a,r,o={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=r.createContext({}),c=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,o=e.mdxType,n=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(a),h=o,k=p["".concat(s,".").concat(h)]||p[h]||m[h]||n;return a?r.createElement(k,i(i({ref:t},u),{},{components:a})):r.createElement(k,i({ref:t},u))}));function k(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=a.length,i=new Array(n);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<n;c++)i[c]=a[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},5424:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>n,metadata:()=>l,toc:()=>c});var r=a(7462),o=(a(7294),a(3905));const n={},i="Sharing a team Heroku account",l={permalink:"/blog/2013/03/22/sharing-a-team-heroku-account.html",source:"@site/blog/2013-03-22-sharing-a-team-heroku-account.html.md",title:"Sharing a team Heroku account",description:"Share a Heroku account for a single place to add/remove team members for all shared apps. Permission allocation/revocation made simple! How? Add a new key for each team member to the shared account; access app repos using the heroku-accounts plugin",date:"2013-03-22T00:00:00.000Z",formattedDate:"March 22, 2013",tags:[],readingTime:2.66,hasTruncateMarker:!0,authors:[],frontMatter:{},prevItem:{title:"Test if memcache is running and accessible",permalink:"/blog/2014/02/03/test-if-memcache-is-running-and-accessible.html"}},s={authorsImageUrls:[]},c=[{value:"Create a work account with a new key",id:"create-a-work-account-with-a-new-key",level:3},{value:"Change team heroku repositories",id:"change-team-heroku-repositories",level:2},{value:"Caveats",id:"caveats",level:2},{value:"That&#39;s all, folks",id:"thats-all-folks",level:2}],u={toc:c},p="wrapper";function m(e){let{components:t,...a}=e;return(0,o.kt)(p,(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("admonition",{title:"TL;DR",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Share a Heroku account for a single place to add/remove team members for all shared apps. Permission allocation/revocation made simple! How? Add a new key for each team member to the shared account; access app repos using the heroku-accounts plugin")),(0,o.kt)("p",null,"Currently at Brightbit there's 4-5 team members to add to each Heroku app. And with some projects having two, three or more apps (staging, production, splash, etc) it gets a bit cumbersome adding all of us and it will only get worse with more team mates."),(0,o.kt)("p",null,"What makes this problem worse is we don't re-bill hosting; we let our clients create an account and then they add us as collaborators. Some clients like this control, some just have us do it for them. Whatever the case, adding a single email for each app is much nicer."),(0,o.kt)("p",null,"To add to the convenience, if we want to add a team member to every Brightbit project we simply add their key to the team account. And if a team member leaves, we change the password and remove their key: instant permission revocation on every project."),(0,o.kt)("p",null,"So how do we achieve this? Open your favorite terminal and follow along."),(0,o.kt)("h3",{id:"create-a-work-account-with-a-new-key"},"Create a work account with a new key"),(0,o.kt)("p",null,"You can only link an SSH key to one Heroku account at a time (how else would it know what account you were pushing from?), so you'll need to create a new key for your work account."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Install the ",(0,o.kt)("a",{parentName:"p",href:"http://github.com/ddollar/heroku-accounts"},"Heroku accounts")," plugin by David Dollar:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"heroku plugins:install git://github.com/ddollar/heroku-accounts.git\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Add a work account and login using the shared team email/password (don't add anything to your ssh config yet -- we'll get to that):"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"heroku accounts:add work\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Generate a dedicated ssh key for your work account (this is your personal key -- don't share this with your team):"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ssh-keygen -f ~/.ssh/id_rsa_heroku_work\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Add your key to the team Heroku account:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"heroku keys:add ~/.ssh/id_rsa_heroku_work.pub --account work\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Add the key to a ",(0,o.kt)("inlineCode",{parentName:"p"},"heroku.work")," host (so you can push/pull with git):"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cat << 'EOF' >> ~/.ssh/config\nHost heroku.work\n  HostName heroku.com\n  IdentityFile ~/.ssh/id_rsa_heroku_work\n  IdentitiesOnly yes\nEOF\n")),(0,o.kt)("h2",{id:"change-team-heroku-repositories"},"Change team heroku repositories"),(0,o.kt)("p",null,"Now to use the account you'll need to replace the ",(0,o.kt)("inlineCode",{parentName:"p"},"heroku.com")," hostname with ",(0,o.kt)("inlineCode",{parentName:"p"},"heroku.work"),". You can do this by removing and re-adding the remote or you can edit your current .git/config."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Here's a 3 liner to modify your current .git/config that should work on any system (it would be a 1 liner if BSD and GNU sed agreed on inline replacement). You'll need to run it on the root of each repository:"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'TMP_FILE=$(mktemp /tmp/config.XXXXXXXXXX)\nsed -e "s/heroku.com/heroku.work/" .git/config > $TMP_FILE\nmv $TMP_FILE .git/config\n'))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Verify it worked (you'll get a public key denied if it didn't):"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"git remote update\n"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"You also may want to set your team repo's default Heroku account (you can use --global for a system-wide change):"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"git config heroku.account work\n")))),(0,o.kt)("h2",{id:"caveats"},"Caveats"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"You won't know who deployed what when you run a ",(0,o.kt)("inlineCode",{parentName:"li"},"heroku releases"),".")),(0,o.kt)("h2",{id:"thats-all-folks"},"That's all, folks"),(0,o.kt)("p",null,"Mention me on twitter (",(0,o.kt)("a",{parentName:"p",href:"http://twitter.com/ericboehs"},"@ericboehs"),") if you run into any problems."),(0,o.kt)("p",null,"Happy coding!"))}m.isMDXComponent=!0}}]);